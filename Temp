962
Rows analysed

10
Flagged rows

1%



Risk filters
Select Region and Location to scope the run.
Region
APAC
Location
Pune
Low (0)
Low Medium (9)
Medium (55)
Medium High (11)
High (0)



this is totally wrong count ..

C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2274: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  raw_metrics_df = grouped_raw.apply(_agg_metrics).reset_index()
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1804: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  for ix, r in df[df['CountSwipes'].fillna(0).astype(int) == 0].iterrows():
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1870: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df['PresentToday'] = df['CountSwipes'].fillna(0).astype(int) > 0
INFO:root:run_trend_for_date: wrote C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\trend_pune_20251118.csv (rows=756)
INFO:root:Fetching swipes for region apac on 2025-11-19
INFO:root:Databases present for server SRVWUPNQ0986V: ['ACVSUJournal_00010030', 'ACVSUJournal_00010029', 'ACVSUJournal_00010028', 'ACVSUJournal_00010027', 'ACVSUJournal_00010026', 'ACVSUJournal_00010025']
INFO:root:Built SQL for region apac, date 2025-11-19
INFO:root:APAC PartitionName2 mapping counts example: {'Pune': 18722, 'Quezon City': 6945, 'IN.HYD': 309, 'SG.Singapore': 187, 'Taguig City': 26}
INFO:root:City filter 'pune' applied for region apac: rows before=26189 after=18722
C:\Users\W0024618\Desktop\Trend Analysis\backend\duration_report.py:918: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.
  df["_lts_rounded"] = df["LocaleMessageTime"].dt.floor("S")
INFO:root:Wrote duration CSV for apac to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\apac_duration_20251119.csv (rows=825)
INFO:root:Wrote swipes CSV for apac to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\apac_swipes_20251119.csv (rows=18722)
C:\Users\W0024618\Desktop\Trend Analysis\backend\duration_report.py:918: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.
  df["_lts_rounded"] = df["LocaleMessageTime"].dt.floor("S")
INFO:root:PersonnelTypeName values example: ['Employee']
INFO:root:PersonnelTypeName filter applied: before=18722 after=18722
INFO:root:Saved raw swipes to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\swipes_pune_20251119.csv
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2274: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  raw_metrics_df = grouped_raw.apply(_agg_metrics).reset_index()
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1804: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  for ix, r in df[df['CountSwipes'].fillna(0).astype(int) == 0].iterrows():
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1870: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df['PresentToday'] = df['CountSwipes'].fillna(0).astype(int) > 0
INFO:root:run_trend_for_date: wrote C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\trend_pune_20251119.csv (rows=826)
INFO:root:Fetching swipes for region apac on 2025-11-20
INFO:root:Databases present for server SRVWUPNQ0986V: ['ACVSUJournal_00010030', 'ACVSUJournal_00010029', 'ACVSUJournal_00010028', 'ACVSUJournal_00010027', 'ACVSUJournal_00010026', 'ACVSUJournal_00010025']
INFO:root:Built SQL for region apac, date 2025-11-20
INFO:root:APAC PartitionName2 mapping counts example: {'Pune': 10247, 'Quezon City': 5051, 'IN.HYD': 306, 'SG.Singapore': 230, 'Taguig City': 46}
INFO:root:City filter 'pune' applied for region apac: rows before=15880 after=10247
C:\Users\W0024618\Desktop\Trend Analysis\backend\duration_report.py:918: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.
  df["_lts_rounded"] = df["LocaleMessageTime"].dt.floor("S")
INFO:root:Wrote duration CSV for apac to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\apac_duration_20251120.csv (rows=463)
INFO:root:Wrote swipes CSV for apac to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\apac_swipes_20251120.csv (rows=10247)
C:\Users\W0024618\Desktop\Trend Analysis\backend\duration_report.py:918: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.
  df["_lts_rounded"] = df["LocaleMessageTime"].dt.floor("S")
INFO:root:PersonnelTypeName values example: ['Employee']
INFO:root:PersonnelTypeName filter applied: before=10247 after=10247
INFO:root:Saved raw swipes to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\swipes_pune_20251120.csv
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2274: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  raw_metrics_df = grouped_raw.apply(_agg_metrics).reset_index()
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1804: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  for ix, r in df[df['CountSwipes'].fillna(0).astype(int) == 0].iterrows():
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1870: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df['PresentToday'] = df['CountSwipes'].fillna(0).astype(int) > 0
INFO:root:run_trend_for_date: wrote C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\trend_pune_20251120.csv (rows=464)
C:\Users\W0024618\Desktop\Trend Analysis\backend\app.py:1126: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`       
  combined_df['_person_key'] = combined_df.apply(lambda r: _person_key_for_row(r), axis=1)
C:\Users\W0024618\Desktop\Trend Analysis\backend\app.py:1129: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  combined_df['_person_key'] = combined_df['_person_key'].fillna(method='ffill').fillna(method='bfill')
ERROR:root:Failed to aggregate persons (non-fatal)
Traceback (most recent call last):
  File "C:\Users\W0024618\Desktop\Trend Analysis\backend\app.py", line 1130, in run_trend
    combined_df['_person_key'] = combined_df['_person_key'].fillna(combined_df.index.map(lambda i: f"row:{i}"))    
                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^    
  File "C:\Users\W0024618\Desktop\Trend Analysis\backend\.venv\Lib\site-packages\pandas\core\generic.py", line 7366, in fillna
    raise TypeError(
    ...<3 lines>...
    )
TypeError: "value" parameter must be a scalar, dict or Series, but you passed a "Index"
INFO:werkzeug:127.0.0.1 - - [21/Nov/2025 19:49:52] "GET /run?start=2025-11-17&end=2025-11-20&full=true&region=apac&city=Pune HTTP/1.1" 200 -



C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2274: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  raw_metrics_df = grouped_raw.apply(_agg_metrics).reset_index()
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1804: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  for ix, r in df[df['CountSwipes'].fillna(0).astype(int) == 0].iterrows():
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1870: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df['PresentToday'] = df['CountSwipes'].fillna(0).astype(int) > 0
INFO:root:run_trend_for_date: wrote C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\trend_pune_20251118.csv (rows=756)
INFO:root:Fetching swipes for region apac on 2025-11-19
INFO:root:Databases present for server SRVWUPNQ0986V: ['ACVSUJournal_00010030', 'ACVSUJournal_00010029', 'ACVSUJournal_00010028', 'ACVSUJournal_00010027', 'ACVSUJournal_00010026', 'ACVSUJournal_00010025']
INFO:root:Built SQL for region apac, date 2025-11-19
INFO:root:APAC PartitionName2 mapping counts example: {'Pune': 18722, 'Quezon City': 6945, 'IN.HYD': 309, 'SG.Singapore': 187, 'Taguig City': 26}
INFO:root:City filter 'pune' applied for region apac: rows before=26189 after=18722
C:\Users\W0024618\Desktop\Trend Analysis\backend\duration_report.py:918: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.
  df["_lts_rounded"] = df["LocaleMessageTime"].dt.floor("S")
INFO:root:Wrote duration CSV for apac to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\apac_duration_20251119.csv (rows=825)
INFO:root:Wrote swipes CSV for apac to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\apac_swipes_20251119.csv (rows=18722)
C:\Users\W0024618\Desktop\Trend Analysis\backend\duration_report.py:918: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.
  df["_lts_rounded"] = df["LocaleMessageTime"].dt.floor("S")
INFO:root:PersonnelTypeName values example: ['Employee']
INFO:root:PersonnelTypeName filter applied: before=18722 after=18722
INFO:root:Saved raw swipes to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\swipes_pune_20251119.csv
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2274: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  raw_metrics_df = grouped_raw.apply(_agg_metrics).reset_index()
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1804: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  for ix, r in df[df['CountSwipes'].fillna(0).astype(int) == 0].iterrows():
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1870: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df['PresentToday'] = df['CountSwipes'].fillna(0).astype(int) > 0
INFO:root:run_trend_for_date: wrote C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\trend_pune_20251119.csv (rows=826)
INFO:root:Fetching swipes for region apac on 2025-11-20
INFO:root:Databases present for server SRVWUPNQ0986V: ['ACVSUJournal_00010030', 'ACVSUJournal_00010029', 'ACVSUJournal_00010028', 'ACVSUJournal_00010027', 'ACVSUJournal_00010026', 'ACVSUJournal_00010025']
INFO:root:Built SQL for region apac, date 2025-11-20
INFO:root:APAC PartitionName2 mapping counts example: {'Pune': 10247, 'Quezon City': 5051, 'IN.HYD': 306, 'SG.Singapore': 230, 'Taguig City': 46}
INFO:root:City filter 'pune' applied for region apac: rows before=15880 after=10247
C:\Users\W0024618\Desktop\Trend Analysis\backend\duration_report.py:918: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.
  df["_lts_rounded"] = df["LocaleMessageTime"].dt.floor("S")
INFO:root:Wrote duration CSV for apac to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\apac_duration_20251120.csv (rows=463)
INFO:root:Wrote swipes CSV for apac to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\apac_swipes_20251120.csv (rows=10247)
C:\Users\W0024618\Desktop\Trend Analysis\backend\duration_report.py:918: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.
  df["_lts_rounded"] = df["LocaleMessageTime"].dt.floor("S")
INFO:root:PersonnelTypeName values example: ['Employee']
INFO:root:PersonnelTypeName filter applied: before=10247 after=10247
INFO:root:Saved raw swipes to C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\swipes_pune_20251120.csv
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2274: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  raw_metrics_df = grouped_raw.apply(_agg_metrics).reset_index()
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:2349: FutureWarning: The behavior of array concatenation with empty entries is deprecated. In a future version, this will no longer exclude empty items when determining the result dtype. To retain the old behavior, exclude the empty entries before the concat operation.
  merged_metrics[base_col] = merged_metrics[raw_col].combine_first(merged_metrics.get(base_col))
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1804: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  for ix, r in df[df['CountSwipes'].fillna(0).astype(int) == 0].iterrows():
C:\Users\W0024618\Desktop\Trend Analysis\backend\trend_runner.py:1870: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df['PresentToday'] = df['CountSwipes'].fillna(0).astype(int) > 0
INFO:root:run_trend_for_date: wrote C:\Users\W0024618\Desktop\Trend Analysis\backend\outputs\trend_pune_20251120.csv (rows=464)
C:\Users\W0024618\Desktop\Trend Analysis\backend\app.py:1126: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`       
  combined_df['_person_key'] = combined_df.apply(lambda r: _person_key_for_row(r), axis=1)
C:\Users\W0024618\Desktop\Trend Analysis\backend\app.py:1129: FutureWarning: Series.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  combined_df['_person_key'] = combined_df['_person_key'].fillna(method='ffill').fillna(method='bfill')
ERROR:root:Failed to aggregate persons (non-fatal)
Traceback (most recent call last):
  File "C:\Users\W0024618\Desktop\Trend Analysis\backend\app.py", line 1130, in run_trend
    combined_df['_person_key'] = combined_df['_person_key'].fillna(combined_df.index.map(lambda i: f"row:{i}"))    
                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^    
  File "C:\Users\W0024618\Desktop\Trend Analysis\backend\.venv\Lib\site-packages\pandas\core\generic.py", line 7366, in fillna
    raise TypeError(
    ...<3 lines>...
    )
TypeError: "value" parameter must be a scalar, dict or Series, but you passed a "Index"
INFO:werkzeug:127.0.0.1 - - [21/Nov/2025 19:49:52] "GET /run?start=2025-11-17&end=2025-11-20&full=true&region=apac&city=Pune HTTP/1.1" 200 -
