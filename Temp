Now as per suggestion i have upadte script deatils now check console details and explain me next step 

D:\Email Automation\backend-arun\start_backend.ps1

[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12

$env:HTTPS_PROXY = "http://proxy.wuintranet.net:8080"
$env:HTTP_PROXY  = $env:HTTPS_PROXY
$env:NO_PROXY = "localhost,127.0.0.1,10.199.22.0/24,10.199.22.57"

$env:CLIENT_ID = "6222d611-678e-4d57-a98b-83faa86fce76"
$env:CLIENT_SECRET = "DKV8Q~Rn4MvlucbxcMsXvAZ6ub_rBVbo-sb6.bGX"
$env:TENANT_ID = "ce3a67f2-5a22-4fb8-a511-815f8924cda6"
$env:PRIMARY_EMAIL = "gsoc-globalsecurityoperationcenter.sharedmailbox@westernunion.com"

python .\app.py




i run this command ad Admin

PS C:\Windows\system32> cd "D:\Email Automation\backend-arun"
PS D:\Email Automation\backend-arun> [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
>>
>> $env:HTTPS_PROXY = "http://proxy.wuintranet.net:8080"
>> $env:HTTP_PROXY  = $env:HTTPS_PROXY
>> $env:NO_PROXY = "localhost,127.0.0.1,10.199.22.0/24,10.199.22.57"
>>
>> $env:CLIENT_ID = "6222d611-678e-4d57-a98b-83faa86fce76"
>> $env:CLIENT_SECRET = "DKV8Q~Rn4MvlucbxcMsXvAZ6ub_rBVbo-sb6.bGX"
>> $env:TENANT_ID = "ce3a67f2-5a22-4fb8-a511-815f8924cda6"
>> $env:PRIMARY_EMAIL = "gsoc-globalsecurityoperationcenter.sharedmailbox@westernunion.com"
>>
>> python .\app.py
DEBUG:filelock:Attempting to acquire lock 1949986153120 on D:\Email Automation\backend-arun\templates.json.lock
DEBUG:filelock:Lock 1949986153120 acquired on D:\Email Automation\backend-arun\templates.json.lock
DEBUG:config:Loaded templates from templates.json
DEBUG:filelock:Attempting to release lock 1949986153120 on D:\Email Automation\backend-arun\templates.json.lock
DEBUG:filelock:Lock 1949986153120 released on D:\Email Automation\backend-arun\templates.json.lock
INFO:log_handler:Ensured email_logs table exists.
INFO:log_handler:Ensured employee_images table exists.
INFO:log_handler:Database writer thread started.
DEBUG:tzlocal:Looking up time zone info from registry
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
 * Serving Flask app 'app'
 * Debug mode: on
DEBUG:filelock:Attempting to acquire lock 1583197552368 on D:\Email Automation\backend-arun\templates.json.lock
DEBUG:filelock:Lock 1583197552368 acquired on D:\Email Automation\backend-arun\templates.json.lock
DEBUG:config:Loaded templates from templates.json
DEBUG:filelock:Attempting to release lock 1583197552368 on D:\Email Automation\backend-arun\templates.json.lock
DEBUG:filelock:Lock 1583197552368 released on D:\Email Automation\backend-arun\templates.json.lock
INFO:log_handler:Ensured email_logs table exists.
INFO:log_handler:Ensured employee_images table exists.
INFO:log_handler:Database writer thread started.
DEBUG:tzlocal:Looking up time zone info from registry
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:__main__:Starting scheduler in the main worker process ONLY.
INFO:apscheduler.scheduler:Added job "check_all_regions" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2025-12-12 12:01:45.097763+05:30 (in 59.989001 seconds)
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching exception list
DEBUG:apscheduler.scheduler:Looking for jobs to run
INFO:apscheduler.executors.default:Running job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 1
2:01:45 IST)" (scheduled at 2025-12-12 12:01:45.097763+05:30)
DEBUG:apscheduler.scheduler:Next wakeup is due at 2025-12-12 12:02:45.097763+05:30 (in 59.994246 seconds)
INFO:__main__:Master lock acquired. Starting check_all_regions job.
INFO:alerts:Checking alerts for APAC server
DEBUG:alerts:[APAC] Fetching rejection data...
INFO:alerts:[APAC] Fetched 8 rejection records.
DEBUG:alerts:[APAC] Fetching alarm data...
INFO:alerts:[APAC] Fetched 10 alarm records.
INFO:alerts:[APAC] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for NAMER server
DEBUG:alerts:[NAMER] Fetching rejection data...
INFO:alerts:[NAMER] Fetched 0 rejection records.
DEBUG:alerts:[NAMER] Fetching alarm data...
INFO:alerts:[NAMER] Fetched 3 alarm records.
INFO:alerts:[NAMER] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for EMEA server
DEBUG:alerts:[EMEA] Fetching rejection data...
INFO:alerts:[EMEA] Fetched 5 rejection records.
DEBUG:alerts:[EMEA] Fetching alarm data...
INFO:alerts:[EMEA] Fetched 0 alarm records.
INFO:alerts:[EMEA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for LACA server
DEBUG:alerts:[LACA] Fetching rejection data...
INFO:alerts:[LACA] Fetched 0 rejection records.
DEBUG:alerts:[LACA] Fetching alarm data...
INFO:alerts:[LACA] Fetched 0 alarm records.
INFO:alerts:[LACA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:__main__:Finished check_all_regions job. Releasing master lock.
INFO:apscheduler.executors.default:Job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 12:02:45
IST)" executed successfully
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2025-12-12 12:03:45.097763+05:30 (in 59.996298 seconds)
INFO:apscheduler.executors.default:Running job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 1
2:03:45 IST)" (scheduled at 2025-12-12 12:02:45.097763+05:30)
INFO:__main__:Master lock acquired. Starting check_all_regions job.
INFO:alerts:Checking alerts for APAC server
DEBUG:alerts:[APAC] Fetching rejection data...
INFO:alerts:[APAC] Fetched 8 rejection records.
DEBUG:alerts:[APAC] Fetching alarm data...
INFO:alerts:[APAC] Fetched 10 alarm records.
INFO:alerts:[APAC] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for NAMER server
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching exception list
DEBUG:alerts:[NAMER] Fetching rejection data...
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
INFO:alerts:[NAMER] Fetched 0 rejection records.
DEBUG:alerts:[NAMER] Fetching alarm data...
INFO:alerts:[NAMER] Fetched 3 alarm records.
INFO:alerts:[NAMER] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for EMEA server
DEBUG:alerts:[EMEA] Fetching rejection data...
INFO:alerts:[EMEA] Fetched 5 rejection records.
DEBUG:alerts:[EMEA] Fetching alarm data...
INFO:alerts:[EMEA] Fetched 0 alarm records.
INFO:alerts:[EMEA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for LACA server
DEBUG:alerts:[LACA] Fetching rejection data...
INFO:alerts:[LACA] Fetched 0 rejection records.
DEBUG:alerts:[LACA] Fetching alarm data...
INFO:alerts:[LACA] Fetched 0 alarm records.
INFO:alerts:[LACA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:__main__:Finished check_all_regions job. Releasing master lock.
INFO:apscheduler.executors.default:Job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 12:03:45
IST)" executed successfully
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2025-12-12 12:04:45.097763+05:30 (in 59.993355 seconds)
INFO:apscheduler.executors.default:Running job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 1
2:04:45 IST)" (scheduled at 2025-12-12 12:03:45.097763+05:30)
INFO:__main__:Master lock acquired. Starting check_all_regions job.
INFO:alerts:Checking alerts for APAC server
DEBUG:alerts:[APAC] Fetching rejection data...
INFO:alerts:[APAC] Fetched 8 rejection records.
DEBUG:alerts:[APAC] Fetching alarm data...
INFO:alerts:[APAC] Fetched 10 alarm records.
INFO:alerts:[APAC] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for NAMER server
DEBUG:alerts:[NAMER] Fetching rejection data...
INFO:alerts:[NAMER] Fetched 0 rejection records.
DEBUG:alerts:[NAMER] Fetching alarm data...
INFO:alerts:[NAMER] Fetched 3 alarm records.
INFO:alerts:[NAMER] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for EMEA server
DEBUG:alerts:[EMEA] Fetching rejection data...
INFO:alerts:[EMEA] Fetched 5 rejection records.
DEBUG:alerts:[EMEA] Fetching alarm data...
INFO:alerts:[EMEA] Fetched 0 alarm records.
INFO:alerts:[EMEA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for LACA server
DEBUG:alerts:[LACA] Fetching rejection data...
INFO:alerts:[LACA] Fetched 0 rejection records.
DEBUG:alerts:[LACA] Fetching alarm data...
INFO:alerts:[LACA] Fetched 0 alarm records.
INFO:alerts:[LACA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:__main__:Finished check_all_regions job. Releasing master lock.
INFO:apscheduler.executors.default:Job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 12:04:45
IST)" executed successfully
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2025-12-12 12:05:45.097763+05:30 (in 59.993409 seconds)
INFO:apscheduler.executors.default:Running job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 1
2:05:45 IST)" (scheduled at 2025-12-12 12:04:45.097763+05:30)
INFO:__main__:Master lock acquired. Starting check_all_regions job.
INFO:alerts:Checking alerts for APAC server
DEBUG:alerts:[APAC] Fetching rejection data...
INFO:alerts:[APAC] Fetched 8 rejection records.
DEBUG:alerts:[APAC] Fetching alarm data...
INFO:alerts:[APAC] Fetched 10 alarm records.
INFO:alerts:[APAC] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for NAMER server
DEBUG:alerts:[NAMER] Fetching rejection data...
INFO:alerts:[NAMER] Fetched 0 rejection records.
DEBUG:alerts:[NAMER] Fetching alarm data...
INFO:alerts:[NAMER] Fetched 3 alarm records.
INFO:alerts:[NAMER] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for EMEA server
DEBUG:alerts:[EMEA] Fetching rejection data...
INFO:alerts:[EMEA] Fetched 5 rejection records.
DEBUG:alerts:[EMEA] Fetching alarm data...
INFO:alerts:[EMEA] Fetched 0 alarm records.
INFO:alerts:[EMEA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for LACA server
DEBUG:alerts:[LACA] Fetching rejection data...
INFO:alerts:[LACA] Fetched 0 rejection records.
DEBUG:alerts:[LACA] Fetching alarm data...
INFO:alerts:[LACA] Fetched 0 alarm records.
INFO:alerts:[LACA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:__main__:Finished check_all_regions job. Releasing master lock.
INFO:apscheduler.executors.default:Job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 12:05:45
IST)" executed successfully
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching email templates
DEBUG:__main__:Fetching email templates
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching image for EmployeeID: W0024618
DEBUG:__main__:Fetching image for EmployeeID: W0024616
DEBUG:__main__:Fetching image for EmployeeID: 311116
DEBUG:__main__:Image found for EmployeeID: W0024618
DEBUG:__main__:Fetching image for EmployeeID: 307426
DEBUG:__main__:Image found for EmployeeID: W0024616
DEBUG:__main__:Image found for EmployeeID: 311116
DEBUG:__main__:Fetching image for EmployeeID: 47442537
DEBUG:__main__:Image found for EmployeeID: 307426
DEBUG:__main__:Image found for EmployeeID: 47442537
DEBUG:__main__:Fetching image for EmployeeID: W0020709
DEBUG:__main__:Image found for EmployeeID: W0020709
DEBUG:__main__:Fetching image for EmployeeID: 86140423
DEBUG:__main__:Image found for EmployeeID: 86140423
DEBUG:__main__:Fetching image for EmployeeID: 311116
DEBUG:__main__:Fetching image for EmployeeID: 47442537
DEBUG:__main__:Image found for EmployeeID: 311116
DEBUG:__main__:Fetching image for EmployeeID: W0024616
DEBUG:__main__:Fetching image for EmployeeID: W0024618
DEBUG:__main__:Image found for EmployeeID: 47442537
DEBUG:__main__:Fetching image for EmployeeID: 307426
DEBUG:__main__:Image found for EmployeeID: W0024616
DEBUG:__main__:Image found for EmployeeID: W0024618
DEBUG:__main__:Image found for EmployeeID: 307426
DEBUG:__main__:Fetching image for EmployeeID: W0020709
DEBUG:__main__:Image found for EmployeeID: W0020709
DEBUG:__main__:Fetching image for EmployeeID: 86140423
DEBUG:__main__:Image found for EmployeeID: 86140423
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching exception list
DEBUG:__main__:Fetching count of acknowledged emails
DEBUG:__main__:Fetching count of sent emails
DEBUG:apscheduler.scheduler:Looking for jobs to run
DEBUG:apscheduler.scheduler:Next wakeup is due at 2025-12-12 12:06:45.097763+05:30 (in 59.993463 seconds)
INFO:apscheduler.executors.default:Running job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 1
2:06:45 IST)" (scheduled at 2025-12-12 12:05:45.097763+05:30)
INFO:__main__:Master lock acquired. Starting check_all_regions job.
INFO:alerts:Checking alerts for APAC server
DEBUG:alerts:[APAC] Fetching rejection data...
INFO:alerts:[APAC] Fetched 8 rejection records.
DEBUG:alerts:[APAC] Fetching alarm data...
INFO:alerts:[APAC] Fetched 10 alarm records.
INFO:alerts:[APAC] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for NAMER server
DEBUG:alerts:[NAMER] Fetching rejection data...
INFO:alerts:[NAMER] Fetched 0 rejection records.
DEBUG:alerts:[NAMER] Fetching alarm data...
INFO:alerts:[NAMER] Fetched 3 alarm records.
INFO:alerts:[NAMER] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for EMEA server
DEBUG:alerts:[EMEA] Fetching rejection data...
INFO:alerts:[EMEA] Fetched 5 rejection records.
DEBUG:alerts:[EMEA] Fetching alarm data...
INFO:alerts:[EMEA] Fetched 0 alarm records.
INFO:alerts:[EMEA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:alerts:Checking alerts for LACA server
DEBUG:alerts:[LACA] Fetching rejection data...
INFO:alerts:[LACA] Fetched 0 rejection records.
DEBUG:alerts:[LACA] Fetching alarm data...
INFO:alerts:[LACA] Fetched 0 alarm records.
INFO:alerts:[LACA] Database connection closed.
INFO:alerts:Location filter is active. Only processing emails for: {('apac', 'pune')}
INFO:__main__:Finished check_all_regions job. Releasing master lock.
DEBUG:__main__:Fetching count of sent emails
DEBUG:__main__:Fetching exception list
INFO:apscheduler.executors.default:Job "check_all_regions (trigger: interval[0:01:00], next run at: 2025-12-12 12:06:45
IST)" executed successfully
PS D:\Email Automation\backend-arun> ^C
PS D:\Email Automation\backend-arun> ^C
PS D:\Email Automation\backend-arun> ^C
PS D:\Email Automation\backend-arun> ^C
PS D:\Email Automation\backend-arun> ^C
PS D:\Email Automation\backend-arun> ^C
PS D:\Email Automation\backend-arun>






















































































































































































































































































































